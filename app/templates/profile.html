<!-- app/templates/profile.html -->
{% extends "base.html" %} {% block title %}Your Profile{% endblock %} {% block
content %}
<header class="bg-white shadow-sm rounded-lg border border-gray-200">
  <div
    class="mx-auto max-w-7xl px-4 py-4 sm:px-6 lg:px-8 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4"
  >
    <h1
      class="text-2xl font-bold tracking-tight text-gray-900 text-center sm:text-left"
    >
      Welcome, {{ user.username }}!
    </h1>
    <div class="flex items-center justify-center gap-x-2 w-full sm:w-auto">
      <a
        href="{{ url_for('main.download_profile_report') }}"
        class="inline-flex items-center gap-x-1.5 rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500"
      >
        <svg
          class="-ml-0.5 h-5 w-5"
          xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)"
          viewBox="0 0 20 20"
          fill="currentColor"
        >
          <path
            d="M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"
          />
          <path
            d="M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"
          />
        </svg>
        My Report
      </a>
      <a
        href="{{ url_for('main.new_diary_entry') }}"
        class="inline-flex items-center gap-x-1.5 rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500"
      >
        <svg
          class="-ml-0.5 h-5 w-5"
          xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)"
          viewBox="0 0 20 20"
          fill="currentColor"
        >
          <path
            d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"
          />
        </svg>
        New Entry
      </a>
    </div>
  </div>
</header>

<div class="mt-8">
  <h2 class="text-xl font-semibold text-gray-700 mb-4 px-4 sm:px-0">
    Your Diary Entries
  </h2>
  {% if entries %}
  <div class="space-y-6">
    {% for entry in entries %}
    <div
      class="bg-white overflow-hidden shadow-md rounded-lg border border-gray-200"
      x-data="{ expanded: false }"
    >
      <div class="px-4 py-5 sm:p-6">
        <div class="flex justify-between items-start">
          <div>
            <h3 class="text-lg font-semibold text-gray-900">
              {{ entry.title }}
            </h3>
            <p class="text-sm text-gray-500 mt-1">
              {{ entry.date_posted.strftime('%B %d, %Y') }}
            </p>
          </div>
          <div class="flex space-x-2 flex-shrink-0 ml-4">
            <a
              href="{{ url_for('main.edit_diary_entry', entry_id=entry.id) }}"
              class="text-gray-400 hover:text-indigo-600"
            >
              <svg
                class="h-5 w-5"
                xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)"
                viewBox="0 0 20 20"
                fill="currentColor"
              >
                <path
                  d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"
                />
                <path
                  fill-rule="evenodd"
                  d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"
                  clip-rule="evenodd"
                />
              </svg>
            </a>
            <form
              action="{{ url_for('main.delete_diary_entry', entry_id=entry.id) }}"
              method="POST"
              onsubmit="return confirm('Are you sure you want to delete this entry?');"
            >
              <input
                type="hidden"
                name="csrf_token"
                value="{{ csrf_token() }}"
              />
              <button type="submit" class="text-gray-400 hover:text-red-600">
                <svg
                  class="h-5 w-5"
                  xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                >
                  <path
                    fill-rule="evenodd"
                    d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z"
                    clip-rule="evenodd"
                  />
                </svg>
              </button>
            </form>
          </div>
        </div>
        <div class="mt-4 text-base text-gray-600 leading-relaxed">
          {% if entry.content|length > 200 %}
          <span x-show="!expanded">{{ entry.content[:200] }}...</span>
          <span x-show="expanded">{{ entry.content }}</span>
          <button
            @click="expanded = !expanded"
            class="text-indigo-600 hover:text-indigo-800 font-semibold mt-2"
            x-text="expanded ? 'See less' : 'See more...'"
          ></button>
          {% else %} {{ entry.content }} {% endif %}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div
    class="text-center py-16 px-4 border-2 border-dashed border-gray-300 rounded-lg"
  >
    <svg
      class="mx-auto h-12 w-12 text-gray-400"
      fill="none"
      viewBox="0 0 24 24"
      stroke="currentColor"
    >
      <path
        vector-effect="non-scaling-stroke"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"
      />
    </svg>
    <h3 class="mt-2 text-sm font-semibold text-gray-900">No entries yet</h3>
    <p class="mt-1 text-sm text-gray-500">
      Get started by writing your first diary entry.
    </p>
  </div>
  {% endif %}
</div>
{% endblock %}
